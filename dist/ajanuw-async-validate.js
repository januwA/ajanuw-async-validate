!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["ajanuw-async-validate"]=e():t["ajanuw-async-validate"]=e()}(this,(function(){return(()=>{"use strict";var t={209:(t,e,r)=>{function i(t){return 0===Object.keys(t).length}function n(t){return"[object Object]"===Object.prototype.toString.call(t)}r.r(e),r.d(e,{AsyncValidate:()=>c});const a="validators";function o(t){return t.hasOwnProperty(a)}function s(t){if(!t)return[];if(Array.isArray(t))return t;if("function"==typeof t)return[t];if(n(t)){let e=[];for(const r in t)if(![a,"fail"].includes(r)){if(!c.hasOwnProperty(r))throw new Error(`[[ AsyncValidate ]] not set "${r}" validate.`);{let i=t[r];Array.isArray(i)||(i=[i]);const n=c[r](...i);e.push(n)}}return t.validators instanceof c||n(t.validators)||(e=e.concat(s(t.validators))),e}return[]}class c{constructor(t,e){this.validateConfig=t,this.options=Object.assign({checkAll:!1,ignore:!0},e)}static oneError(t){if(t&&Object.keys(t).length)return Object.values(t[Object.keys(t)[0]].errors)[0]}static mixin(t){Object.keys(t).filter((t=>{if(!c.hasOwnProperty(t))return t})).forEach((e=>c[e]=t[e]))}async _eachValidators(t,e,r,i){if(null!==this.validateConfig[t]){const n=s(this.validateConfig[t]);for(const t of n){const n=await t(e,r);n&&i(n)}}}_fail(t){i(t)||(this.options.fail?this.options.fail(t):c.fail&&c.fail(t))}async validate(t){const e={};let r=!0;for(const[a,s]of Object.entries(t)){if(!this.validateConfig.hasOwnProperty(a)){this.options.ignore||console.warn(`[[ AsyncValidate ]] "${a}" validate is not set.`);continue}const l=this.validateConfig[a];if(null!==l){if(await this._eachValidators(a,s,t,(t=>{e[a]||(e[a]={value:s,errors:{}}),Object.assign(e[a].errors,t)})),e.hasOwnProperty(a)&&l.hasOwnProperty("fail")&&l.fail(e[a]),r=i(e),!r&&!this.options.checkAll){this._fail(e);break}if(o(l)&&n(l.validators)&&(l.validators=new c(l.validators,this.options)),o(l)&&l.validators instanceof c){const t=l.validators;if(t.options.fail||(t.options.fail=this.options.fail),r=await t.validate(s),!r&&!this.options.checkAll)break}}}return!r&&this.options.checkAll&&this._fail(e),r}static required(t){return e=>{if(!e)return{required:t}}}static minLength(t,e){return r=>{if(r.length<parseFloat(t))return{minLength:e}}}static maxLength(t,e){return r=>{if(r.length>parseFloat(t))return{maxLength:e}}}static phone(t){return e=>{if("string"==typeof e&&!e.match(c.PHONE_EXP))return{phone:t}}}static eql(t,e){return r=>{if(r!==t)return{eql:e}}}static equal(t,e){return r=>{if(r!=t)return{equal:e}}}static bool(t){return e=>{if(!0!==e&&!1!==e)return{bool:t}}}static email(t){return e=>{if(!e.match(c.EMAIL_EXP))return{email:t}}}static max(t,e){return r=>{if(!isNaN(r)&&r>parseFloat(t))return{max:e}}}static min(t,e){return r=>{if(!isNaN(r)&&r<parseFloat(t))return{min:e}}}static hex(t){return e=>{if(e=(e=e.replace(/^0x/i,"")).replace(/h$/i,""),/[^0-9a-fA-F]/.test(e))return{hex:t}}}static number(t){return e=>{if(!Number.isFinite(e)||"number"!=typeof e)return{number:t}}}static int(t){return(e,r)=>{if(this.number("")(e,r)||!Number.isSafeInteger(e))return{int:t}}}static float(t){return(e,r)=>{if(this.number("")(e,r)||Number.isInteger(e))return{float:t}}}static array(t){return e=>{if(!Array.isArray(e))return{array:t}}}static object(t){return e=>{if("[object Object]"!==Object.prototype.toString.call(e))return{object:t}}}static json(t){return e=>{try{JSON.parse(e)}catch(e){return{json:t}}}}static regexp(t){return e=>{if(!(e instanceof RegExp))return{regexp:t}}}}c.PHONE_EXP=/^((13[0-9])|(14[0-9])|(15[0-9])|(16[0-9])|(17[0-9])|(18[0-9])|(19[0-9]))\d{8}$/,c.EMAIL_EXP=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/}},e={};function r(i){if(e[i])return e[i].exports;var n=e[i]={exports:{}};return t[i](n,n.exports,r),n.exports}return r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(209)})()}));