!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports["ajanuw-async-validate"]=e():t["ajanuw-async-validate"]=e()}(this,(function(){return(()=>{"use strict";var t={d:(e,r)=>{for(var i in r)t.o(r,i)&&!t.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:r[i]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},e={};function r(t){return 0===Object.keys(t).length}function i(t){return"[object Object]"===Object.prototype.toString.call(t)}t.r(e),t.d(e,{AsyncValidate:()=>s});const a="validators";function n(t){return t.hasOwnProperty(a)}function o(t){if(!t)return[];if(Array.isArray(t))return t;if("function"==typeof t)return[t];if(i(t)){let e=[];for(const r in t)if(![a,"fail"].includes(r)){if(!s.hasOwnProperty(r))throw new Error(`[[ AsyncValidate ]] not set "${r}" validate.`);{let i=t[r];Array.isArray(i)||(i=[i]);const a=s[r](...i);e.push(a)}}return t.validators instanceof s||i(t.validators)||(e=e.concat(o(t.validators))),e}return[]}class s{constructor(t,e){this.validateConfig=t,this.options=Object.assign({checkAll:!1,ignore:!0},e)}static firstError(t){if(t&&Object.keys(t).length)return Object.values(t[Object.keys(t)[0]].errors)[0]}static mixin(t){Object.keys(t).filter((t=>{if(!s.hasOwnProperty(t))return t})).forEach((e=>s[e]=t[e]))}async _eachValidators(t,e,r,i){if(null!==this.validateConfig[t]){const a=o(this.validateConfig[t]);for(const t of a){const a=await t(e,r);a&&i(a)}}}_fail(t){r(t)||(this.options.fail?this.options.fail(t):s.fail&&s.fail(t))}async validate(t){const e={};let a=!0;for(const[o,c]of Object.entries(t)){if(!this.validateConfig.hasOwnProperty(o)){this.options.ignore||console.warn(`[[ AsyncValidate ]] "${o}" validate is not set.`);continue}const l=this.validateConfig[o];if(null!==l){if(await this._eachValidators(o,c,t,(t=>{e[o]||(e[o]={value:c,errors:{}}),Object.assign(e[o].errors,t)})),e.hasOwnProperty(o)&&l.hasOwnProperty("fail")&&l.fail(e[o]),a=r(e),!a&&!this.options.checkAll){this._fail(e);break}if(n(l)&&i(l.validators)&&(l.validators=new s(l.validators,this.options)),n(l)&&l.validators instanceof s){const t=l.validators;if(t.options.fail||(t.options.fail=this.options.fail),a=await t.validate(c),!a&&!this.options.checkAll)break}}}return!a&&this.options.checkAll&&this._fail(e),a}static required(t){return e=>{if(!e)return{required:t}}}static minLength(t,e){return r=>{if(r.length<parseFloat(t))return{minLength:e}}}static maxLength(t,e){return r=>{if(r.length>parseFloat(t))return{maxLength:e}}}static phone(t){return e=>{if("string"==typeof e&&!e.match(s.PHONE_EXP))return{phone:t}}}static eql(t,e){return r=>{if(r!==t)return{eql:e}}}static equal(t,e){return r=>{if(r!=t)return{equal:e}}}static bool(t){return e=>{if(!0!==e&&!1!==e)return{bool:t}}}static email(t){return e=>{if(!e.match(s.EMAIL_EXP))return{email:t}}}static max(t,e){return r=>{if(!isNaN(r)&&r>parseFloat(t))return{max:e}}}static min(t,e){return r=>{if(!isNaN(r)&&r<parseFloat(t))return{min:e}}}static hex(t){return e=>{if(e=(e=e.replace(/^0x/i,"")).replace(/h$/i,""),/[^0-9a-fA-F]/.test(e))return{hex:t}}}static number(t){return e=>{if(!Number.isFinite(e)||"number"!=typeof e)return{number:t}}}static int(t){return(e,r)=>{if(this.number("")(e,r)||!Number.isSafeInteger(e))return{int:t}}}static float(t){return(e,r)=>{if(this.number("")(e,r)||Number.isInteger(e))return{float:t}}}static array(t){return e=>{if(!Array.isArray(e))return{array:t}}}static object(t){return e=>{if("[object Object]"!==Object.prototype.toString.call(e))return{object:t}}}static json(t){return e=>{try{JSON.parse(e)}catch(e){return{json:t}}}}static regexp(t){return e=>{if(!(e instanceof RegExp))return{regexp:t}}}}return s.PHONE_EXP=/^((13[0-9])|(14[0-9])|(15[0-9])|(16[0-9])|(17[0-9])|(18[0-9])|(19[0-9]))\d{8}$/,s.EMAIL_EXP=/^(?=.{1,254}$)(?=.{1,64}@)[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-]+)*@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,e})()}));